!function(){window.$jit=function(e){e=e||window;for(var t in $jit)$jit[t].$extend&&(e[t]=$jit[t])},$jit.version="2.0.1";var e=function(e){return document.getElementById(e)};e.empty=function(){},e.extend=function(e,t){for(var n in t||{})e[n]=t[n];return e},e.lambda=function(e){return"function"==typeof e?e:function(){return e}},e.time=Date.now||function(){return+new Date},e.splat=function(t){var n=e.type(t);return n?"array"!=n?[t]:t:[]},e.type=function(t){var n=e.type.s.call(t).match(/^\[object\s(.*)\]$/)[1].toLowerCase();return"object"!=n?n:t&&t.$$family?t.$$family:t&&t.nodeName&&1==t.nodeType?"element":n},e.type.s=Object.prototype.toString,e.each=function(t,n){var i=e.type(t);if("object"==i)for(var a in t)n(t[a],a);else for(var o=0,s=t.length;s>o;o++)n(t[o],o)},e.indexOf=function(e,t){if(Array.indexOf)return e.indexOf(t);for(var n=0,i=e.length;i>n;n++)if(e[n]===t)return n;return-1},e.map=function(t,n){var i=[];return e.each(t,function(e,t){i.push(n(e,t))}),i},e.reduce=function(e,t,n){var i=e.length;if(0==i)return n;for(var a=3==arguments.length?n:e[--i];i--;)a=t(a,e[i]);return a},e.merge=function(){for(var t={},n=0,i=arguments.length;i>n;n++){var a=arguments[n];if("object"==e.type(a))for(var o in a){var s=a[o],r=t[o];t[o]=r&&"object"==e.type(s)&&"object"==e.type(r)?e.merge(r,s):e.unlink(s)}}return t},e.unlink=function(t){var n;switch(e.type(t)){case"object":n={};for(var i in t)n[i]=e.unlink(t[i]);break;case"array":n=[];for(var a=0,o=t.length;o>a;a++)n[a]=e.unlink(t[a]);break;default:return t}return n},e.zip=function(){if(0===arguments.length)return[];for(var e=0,t=[],n=arguments.length,i=arguments[0].length;i>e;e++){for(var a=0,o=[];n>a;a++)o.push(arguments[a][e]);t.push(o)}return t},e.rgbToHex=function(e,t){if(e.length<3)return null;if(4==e.length&&0==e[3]&&!t)return"transparent";for(var n=[],i=0;3>i;i++){var a=(e[i]-0).toString(16);n.push(1==a.length?"0"+a:a)}return t?n:"#"+n.join("")},e.hexToRgb=function(e){if(7!=e.length){if(e=e.match(/^#?(\w{1,2})(\w{1,2})(\w{1,2})$/),e.shift(),3!=e.length)return null;for(var t=[],n=0;3>n;n++){var i=e[n];1==i.length&&(i+=i),t.push(parseInt(i,16))}return t}return e=parseInt(e.slice(1),16),[e>>16,e>>8&255,255&e]},e.destroy=function(t){e.clean(t),t.parentNode&&t.parentNode.removeChild(t),t.clearAttributes&&t.clearAttributes()},e.clean=function(t){for(var n=t.childNodes,i=0,a=n.length;a>i;i++)e.destroy(n[i])},e.addEvent=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)},e.addEvents=function(t,n){for(var i in n)e.addEvent(t,i,n[i])},e.hasClass=function(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")>-1},e.addClass=function(t,n){e.hasClass(t,n)||(t.className=t.className+" "+n)},e.removeClass=function(e,t){e.className=e.className.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)"),"$1")},e.getPos=function(e){function t(e){for(var t={x:0,y:0};e&&!i(e);)t.x+=e.offsetLeft,t.y+=e.offsetTop,e=e.offsetParent;return t}function n(e){for(var t={x:0,y:0};e&&!i(e);)t.x+=e.scrollLeft,t.y+=e.scrollTop,e=e.parentNode;return t}function i(e){return/^(?:body|html)$/i.test(e.tagName)}var a=t(e),o=n(e);return{x:a.x-o.x,y:a.y-o.y}},e.event={get:function(e,t){return t=t||window,e||t.event},getWheel:function(e){return e.wheelDelta?e.wheelDelta/120:-(e.detail||0)/3},isRightClick:function(e){return 3==e.which||2==e.button},getPos:function(e,t){t=t||window,e=e||t.event;var n=t.document;n=n.documentElement||n.body,e.touches&&e.touches.length&&(e=e.touches[0]);var i={x:e.pageX||e.clientX+n.scrollLeft,y:e.pageY||e.clientY+n.scrollTop};return i},stop:function(e){e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0,e.preventDefault?e.preventDefault():e.returnValue=!1}},$jit.util=$jit.id=e;var t=function(n){n=n||{};var i=function(){for(var n in this)"function"!=typeof this[n]&&(this[n]=e.unlink(this[n]));if(this.constructor=i,t.prototyping)return this;var a=this.initialize?this.initialize.apply(this,arguments):this;return this.$$family="class",a};for(var a in t.Mutators)n[a]&&(n=t.Mutators[a](n,n[a]),delete n[a]);return e.extend(i,this),i.constructor=t,i.prototype=n,i};t.Mutators={Implements:function(n,i){return e.each(e.splat(i),function(e){t.prototyping=e;var i="function"==typeof e?new e:e;for(var a in i)a in n||(n[a]=i[a]);delete t.prototyping}),n}},e.extend(t,{inherit:function(n,i){for(var a in i){var o=i[a],s=n[a],r=e.type(o);s&&"function"==r?o!=s&&t.override(n,a,o):"object"==r?n[a]=e.merge(s,o):n[a]=o}return n},override:function(e,n,i){var a=t.prototyping;a&&e[n]!=a[n]&&(a=null);var o=function(){var t=this.parent;this.parent=a?a[n]:e[n];var o=i.apply(this,arguments);return this.parent=t,o};e[n]=o}}),t.prototype.implement=function(){var n=this.prototype;return e.each(Array.prototype.slice.call(arguments||[]),function(e){t.inherit(n,e)}),this},$jit.Class=t,$jit.json={prune:function(e,t){this.each(e,function(e,n){n==t&&e.children&&(delete e.children,e.children=[])})},getParent:function(e,t){if(e.id==t)return!1;var n=e.children;if(n&&n.length>0)for(var i=0;i<n.length;i++){if(n[i].id==t)return e;var a=this.getParent(n[i],t);if(a)return a}return!1},getSubtree:function(e,t){if(e.id==t)return e;for(var n=0,i=e.children;i&&n<i.length;n++){var a=this.getSubtree(i[n],t);if(null!=a)return a}return null},eachLevel:function(e,t,n,i){if(n>=t){if(i(e,t),!e.children)return;for(var a=0,o=e.children;a<o.length;a++)this.eachLevel(o[a],t+1,n,i)}},each:function(e,t){this.eachLevel(e,0,Number.MAX_VALUE,t)}},$jit.Trans={$extend:!0,linear:function(e){return e}};var n=$jit.Trans;!function(){var t=function(t,n){return n=e.splat(n),e.extend(t,{easeIn:function(e){return t(e,n)},easeOut:function(e){return 1-t(1-e,n)},easeInOut:function(e){return.5>=e?t(2*e,n)/2:(2-t(2*(1-e),n))/2}})},i={Pow:function(e,t){return Math.pow(e,t[0]||6)},Expo:function(e){return Math.pow(2,8*(e-1))},Circ:function(e){return 1-Math.sin(Math.acos(e))},Sine:function(e){return 1-Math.sin((1-e)*Math.PI/2)},Back:function(e,t){return t=t[0]||1.618,Math.pow(e,2)*((t+1)*e-t)},Bounce:function(e){for(var t,n=0,i=1;1;n+=i,i/=2)if(e>=(7-4*n)/11){t=i*i-Math.pow((11-6*n-11*e)/4,2);break}return t},Elastic:function(e,t){return Math.pow(2,10*--e)*Math.cos(20*e*Math.PI*(t[0]||1)/3)}};e.each(i,function(e,i){n[i]=t(e)}),e.each(["Quad","Cubic","Quart","Quint"],function(e,i){n[e]=t(function(e){return Math.pow(e,[i+2])})})}();var i=new t({initialize:function(e){this.setOptions(e)},setOptions:function(t){var i={duration:2500,fps:40,transition:n.Quart.easeInOut,compute:e.empty,complete:e.empty,link:"ignore"};return this.opt=e.merge(i,t||{}),this},step:function(){var t=e.time(),n=this.opt;if(t<this.time+n.duration){var i=n.transition((t-this.time)/n.duration);n.compute(i)}else this.timer=clearInterval(this.timer),n.compute(1),n.complete()},start:function(){return this.check()?(this.time=0,this.startTimer(),this):this},startTimer:function(){var t=this,n=this.opt.fps;return this.timer?!1:(this.time=e.time()-this.time,this.timer=setInterval(function(){t.step()},Math.round(1e3/n)),!0)},pause:function(){return this.stopTimer(),this},resume:function(){return this.startTimer(),this},stopTimer:function(){return this.timer?(this.time=e.time()-this.time,this.timer=clearInterval(this.timer),!0):!1},check:function(){return this.timer?"cancel"==this.opt.link?(this.stopTimer(),!0):!1:!0}}),a=function(){for(var t=arguments,n=0,i=t.length,o={};i>n;n++){var s=a[t[n]];s.$extend?e.extend(o,s):o[t[n]]=s}return o};a.AreaChart={$extend:!0,animate:!0,labelOffset:3,type:"stacked",Tips:{enable:!1,onShow:e.empty,onHide:e.empty},Events:{enable:!1,onClick:e.empty},selectOnHover:!0,showAggregates:!0,showLabels:!0,filterOnClick:!1,restoreOnRightClick:!1},a.Margin={$extend:!1,top:0,left:0,right:0,bottom:0},a.Canvas={$extend:!0,injectInto:"id",type:"2D",width:!1,height:!1,useCanvas:!1,withLabels:!0,background:!1,Scene:{Lighting:{enable:!1,ambient:[1,1,1],directional:{direction:{x:-100,y:-100,z:-100},color:[.5,.3,.1]}}}},a.Tree={$extend:!0,orientation:"left",subtreeOffset:8,siblingOffset:5,indent:10,multitree:!1,align:"center"},a.Node={$extend:!1,overridable:!1,type:"circle",color:"#ccb",alpha:1,dim:3,height:20,width:90,autoHeight:!1,autoWidth:!1,lineWidth:1,transform:!0,align:"center",angularWidth:1,span:1,CanvasStyles:{}},a.Edge={$extend:!1,overridable:!1,type:"line",color:"#ccb",lineWidth:1,dim:15,alpha:1,epsilon:7,CanvasStyles:{}},a.Fx={$extend:!0,fps:40,duration:2500,transition:$jit.Trans.Quart.easeInOut,clearCanvas:!0},a.Label={$extend:!1,overridable:!1,type:"HTML",style:" ",size:10,family:"sans-serif",textAlign:"center",textBaseline:"alphabetic",color:"#fff"},a.Tips={$extend:!1,enable:!1,type:"auto",offsetX:20,offsetY:20,force:!1,onShow:e.empty,onHide:e.empty},a.NodeStyles={$extend:!1,enable:!1,type:"auto",stylesHover:!1,stylesClick:!1},a.Events={$extend:!1,enable:!1,enableForEdges:!1,type:"auto",onClick:e.empty,onRightClick:e.empty,onMouseMove:e.empty,onMouseEnter:e.empty,onMouseLeave:e.empty,onDragStart:e.empty,onDragMove:e.empty,onDragCancel:e.empty,onDragEnd:e.empty,onTouchStart:e.empty,onTouchMove:e.empty,onTouchEnd:e.empty,onMouseWheel:e.empty},a.Navigation={$extend:!1,enable:!1,type:"auto",panning:!1,zooming:!1},a.Controller={$extend:!0,onBeforeCompute:e.empty,onAfterCompute:e.empty,onCreateLabel:e.empty,onPlaceLabel:e.empty,onComplete:e.empty,onBeforePlotLine:e.empty,onAfterPlotLine:e.empty,onBeforePlotNode:e.empty,onAfterPlotNode:e.empty,request:!1};var o={initialize:function(e,t){this.viz=t,this.canvas=t.canvas,this.config=t.config[e],this.nodeTypes=t.fx.nodeTypes;var n=this.config.type;this.dom="auto"==n?"Native"!=t.config.Label.type:"Native"!=n,this.labelContainer=this.dom&&t.labels.getLabelContainer(),this.isEnabled()&&this.initializePost()},initializePost:e.empty,setAsProperty:e.lambda(!1),isEnabled:function(){return this.config.enable},isLabel:function(t,n,i){t=e.event.get(t,n);var a=this.labelContainer,o=t.target||t.srcElement,s=t.relatedTarget;return i?s&&s==this.viz.canvas.getCtx().canvas&&!!o&&this.isDescendantOf(o,a):this.isDescendantOf(o,a)},isDescendantOf:function(e,t){for(;e&&e.parentNode;){if(e.parentNode==t)return e;e=e.parentNode}return!1}},s={onMouseUp:e.empty,onMouseDown:e.empty,onMouseMove:e.empty,onMouseOver:e.empty,onMouseOut:e.empty,onMouseWheel:e.empty,onTouchStart:e.empty,onTouchMove:e.empty,onTouchEnd:e.empty,onTouchCancel:e.empty},r=new t({initialize:function(e){this.viz=e,this.canvas=e.canvas,this.node=!1,this.edge=!1,this.registeredObjects=[],this.attachEvents()},attachEvents:function(){var t=this.canvas.getElement(),n=this;t.oncontextmenu=e.lambda(!1),e.addEvents(t,{mouseup:function(t,i){var a=e.event.get(t,i);n.handleEvent("MouseUp",t,i,n.makeEventObject(t,i),e.event.isRightClick(a))},mousedown:function(t,i){var a=e.event.get(t,i);n.handleEvent("MouseDown",t,i,n.makeEventObject(t,i),e.event.isRightClick(a))},mousemove:function(e,t){n.handleEvent("MouseMove",e,t,n.makeEventObject(e,t))},mouseover:function(e,t){n.handleEvent("MouseOver",e,t,n.makeEventObject(e,t))},mouseout:function(e,t){n.handleEvent("MouseOut",e,t,n.makeEventObject(e,t))},touchstart:function(e,t){n.handleEvent("TouchStart",e,t,n.makeEventObject(e,t))},touchmove:function(e,t){n.handleEvent("TouchMove",e,t,n.makeEventObject(e,t))},touchend:function(e,t){n.handleEvent("TouchEnd",e,t,n.makeEventObject(e,t))}});var i=function(t,i){var a=e.event.get(t,i),o=e.event.getWheel(a);n.handleEvent("MouseWheel",t,i,o)};document.getBoxObjectFor||null!=window.mozInnerScreenX?t.addEventListener("DOMMouseScroll",i,!1):e.addEvent(t,"mousewheel",i)},register:function(e){this.registeredObjects.push(e)},handleEvent:function(){for(var e=Array.prototype.slice.call(arguments),t=e.shift(),n=0,i=this.registeredObjects,a=i.length;a>n;n++)i[n]["on"+t].apply(i[n],e)},makeEventObject:function(t,n){var i=this,a=this.viz.graph,o=this.viz.fx,s=o.nodeTypes,r=o.edgeTypes;return{pos:!1,node:!1,edge:!1,contains:!1,getNodeCalled:!1,getEdgeCalled:!1,getPos:function(){var a=i.viz.canvas,o=a.getSize(),s=a.getPos(),r=a.translateOffsetX,h=a.translateOffsetY,l=a.scaleOffsetX,c=a.scaleOffsetY,d=e.event.getPos(t,n);return this.pos={x:1*(d.x-s.x-o.width/2-r)/l,y:1*(d.y-s.y-o.height/2-h)/c},this.pos},getNode:function(){if(this.getNodeCalled)return this.node;this.getNodeCalled=!0;for(var e in a.nodes){var t=a.nodes[e],n=t&&s[t.getData("type")],r=n&&n.contains&&n.contains.call(o,t,this.getPos());if(r)return this.contains=r,i.node=this.node=t}return i.node=this.node=!1},getEdge:function(){if(this.getEdgeCalled)return this.edge;this.getEdgeCalled=!0;var e={};for(var t in a.edges){var n=a.edges[t];e[t]=!0;for(var s in n)if(!(s in e)){var h=n[s],l=h&&r[h.getData("type")],c=l&&l.contains&&l.contains.call(o,h,this.getPos());if(c)return this.contains=c,i.edge=this.edge=h}}return i.edge=this.edge=!1},getContains:function(){return this.getNodeCalled?this.contains:(this.getNode(),this.contains)}}}}),h={initializeExtras:function(){var t=new r(this),n=this;e.each(["NodeStyles","Tips","Navigation","Events"],function(e){var i=new h.Classes[e](e,n);i.isEnabled()&&t.register(i),i.setAsProperty()&&(n[e.toLowerCase()]=i)})}};h.Classes={},h.Classes.Events=new t({Implements:[o,s],initializePost:function(){this.fx=this.viz.fx,this.ntypes=this.viz.fx.nodeTypes,this.etypes=this.viz.fx.edgeTypes,this.hovered=!1,this.pressed=!1,this.touched=!1,this.touchMoved=!1,this.moved=!1},setAsProperty:e.lambda(!0),onMouseUp:function(t,n,i,a){var o=e.event.get(t,n);this.moved||(a?this.config.onRightClick(this.hovered,i,o):this.config.onClick(this.pressed,i,o)),this.pressed&&(this.moved?this.config.onDragEnd(this.pressed,i,o):this.config.onDragCancel(this.pressed,i,o),this.pressed=this.moved=!1)},onMouseOut:function(t,n,i){var a,o=e.event.get(t,n);if(this.dom&&(a=this.isLabel(t,n,!0)))return this.config.onMouseLeave(this.viz.graph.getNode(a.id),i,o),void(this.hovered=!1);for(var s=o.relatedTarget,r=this.canvas.getElement();s&&s.parentNode;){if(r==s.parentNode)return;s=s.parentNode}this.hovered&&(this.config.onMouseLeave(this.hovered,i,o),this.hovered=!1)},onMouseOver:function(t,n,i){var a,o=e.event.get(t,n);this.dom&&(a=this.isLabel(t,n,!0))&&(this.hovered=this.viz.graph.getNode(a.id),this.config.onMouseEnter(this.hovered,i,o))},onMouseMove:function(t,n,i){var a=e.event.get(t,n);if(this.pressed)return this.moved=!0,void this.config.onDragMove(this.pressed,i,a);if(this.dom)this.config.onMouseMove(this.hovered,i,a);else{if(this.hovered){var o=this.hovered,s=o.nodeFrom?this.etypes[o.getData("type")]:this.ntypes[o.getData("type")],r=s&&s.contains&&s.contains.call(this.fx,o,i.getPos());if(r)return void this.config.onMouseMove(o,i,a);this.config.onMouseLeave(o,i,a),this.hovered=!1}(this.hovered=i.getNode()||this.config.enableForEdges&&i.getEdge())?this.config.onMouseEnter(this.hovered,i,a):this.config.onMouseMove(!1,i,a)}},onMouseWheel:function(t,n,i){this.config.onMouseWheel(i,e.event.get(t,n))},onMouseDown:function(t,n,i){var a,o=e.event.get(t,n);this.dom?(a=this.isLabel(t,n))&&(this.pressed=this.viz.graph.getNode(a.id)):this.pressed=i.getNode()||this.config.enableForEdges&&i.getEdge(),this.pressed&&this.config.onDragStart(this.pressed,i,o)},onTouchStart:function(t,n,i){var a,o=e.event.get(t,n);this.dom&&(a=this.isLabel(t,n))?this.touched=this.viz.graph.getNode(a.id):this.touched=i.getNode()||this.config.enableForEdges&&i.getEdge(),this.touched&&this.config.onTouchStart(this.touched,i,o)},onTouchMove:function(t,n,i){var a=e.event.get(t,n);this.touched&&(this.touchMoved=!0,this.config.onTouchMove(this.touched,i,a))},onTouchEnd:function(t,n,i){var a=e.event.get(t,n);this.touched&&(this.touchMoved?this.config.onTouchEnd(this.touched,i,a):this.config.onTouchCancel(this.touched,i,a),this.touched=this.touchMoved=!1)}}),h.Classes.Tips=new t({Implements:[o,s],initializePost:function(){if(document.body){var t=e("_tooltip")||document.createElement("div");t.id="_tooltip",t.className="tip",e.extend(t.style,{position:"absolute",display:"none",zIndex:13e3}),document.body.appendChild(t),this.tip=t,this.node=!1}},setAsProperty:e.lambda(!0),onMouseOut:function(t,n){e.event.get(t,n);if(this.dom&&this.isLabel(t,n,!0))return void this.hide(!0);for(var i=t.relatedTarget,a=this.canvas.getElement();i&&i.parentNode;){if(a==i.parentNode)return;i=i.parentNode}this.hide(!1)},onMouseOver:function(e,t){var n;this.dom&&(n=this.isLabel(e,t,!1))&&(this.node=this.viz.graph.getNode(n.id),this.config.onShow(this.tip,this.node,n))},onMouseMove:function(t,n,i){if(this.dom&&this.isLabel(t,n)&&this.setTooltipPosition(e.event.getPos(t,n)),!this.dom){var a=i.getNode();if(!a)return void this.hide(!0);(this.config.force||!this.node||this.node.id!=a.id)&&(this.node=a,this.config.onShow(this.tip,a,i.getContains())),this.setTooltipPosition(e.event.getPos(t,n))}},setTooltipPosition:function(e){var t=this.tip,n=t.style,i=this.config;n.display="";var a={height:document.body.clientHeight,width:document.body.clientWidth},o={width:t.offsetWidth,height:t.offsetHeight},s=i.offsetX,r=i.offsetY;n.top=(e.y+r+o.height>a.height?e.y-o.height-r:e.y+r)+"px",n.left=(e.x+o.width+s>a.width?e.x-o.width-s:e.x+s)+"px"},hide:function(e){this.tip.style.display="none",e&&this.config.onHide()}}),h.Classes.NodeStyles=new t({Implements:[o,s],initializePost:function(){this.fx=this.viz.fx,this.types=this.viz.fx.nodeTypes,this.nStyles=this.config,this.nodeStylesOnHover=this.nStyles.stylesHover,this.nodeStylesOnClick=this.nStyles.stylesClick,this.hoveredNode=!1,this.fx.nodeFxAnimation=new i,this.down=!1,this.move=!1},onMouseOut:function(e,t){if(this.down=this.move=!1,this.hoveredNode){this.dom&&this.isLabel(e,t,!0)&&this.toggleStylesOnHover(this.hoveredNode,!1);for(var n=e.relatedTarget,i=this.canvas.getElement();n&&n.parentNode;){if(i==n.parentNode)return;n=n.parentNode}this.toggleStylesOnHover(this.hoveredNode,!1),this.hoveredNode=!1}},onMouseOver:function(e,t){var n;if(this.dom&&(n=this.isLabel(e,t,!0))){var i=this.viz.graph.getNode(n.id);if(i.selected)return;this.hoveredNode=i,this.toggleStylesOnHover(this.hoveredNode,!0)}},onMouseDown:function(e,t,n,i){if(!i){var a;this.dom&&(a=this.isLabel(e,t))?this.down=this.viz.graph.getNode(a.id):this.dom||(this.down=n.getNode()),this.move=!1}},onMouseUp:function(e,t,n,i){i||(this.move||this.onClick(n.getNode()),this.down=this.move=!1)},getRestoredStyles:function(e,t){var n={},i=this["nodeStylesOn"+t];for(var a in i)n[a]=e.styles["$"+a];return n},toggleStylesOnHover:function(e,t){this.nodeStylesOnHover&&this.toggleStylesOn("Hover",e,t)},toggleStylesOnClick:function(e,t){this.nodeStylesOnClick&&this.toggleStylesOn("Click",e,t)},toggleStylesOn:function(t,i,a){var o=this.viz;this.nStyles;if(a){var s=this;i.styles||(i.styles=e.merge(i.data,{}));for(var r in this["nodeStylesOn"+t]){var h="$"+r;h in i.styles||(i.styles[h]=i.getData(r))}o.fx.nodeFx(e.extend({elements:{id:i.id,properties:s["nodeStylesOn"+t]},transition:n.Quart.easeOut,duration:300,fps:40},this.config))}else{var l=this.getRestoredStyles(i,t);o.fx.nodeFx(e.extend({elements:{id:i.id,properties:l},transition:n.Quart.easeOut,duration:300,fps:40},this.config))}},onClick:function(e){if(e){var t=this.nodeStylesOnClick;t&&(e.selected?(this.toggleStylesOnClick(e,!1),delete e.selected):(this.viz.graph.eachNode(function(e){if(e.selected){for(var n in t)e.setData(n,e.styles["$"+n],"end");delete e.selected}}),this.toggleStylesOnClick(e,!0),e.selected=!0,delete e.hovered,this.hoveredNode=!1))}},onMouseMove:function(e,t,n){if(this.down&&(this.move=!0),!this.dom||!this.isLabel(e,t)){var i=this.nodeStylesOnHover;if(i&&!this.dom){if(this.hoveredNode){var a=this.types[this.hoveredNode.getData("type")],o=a&&a.contains&&a.contains.call(this.fx,this.hoveredNode,n.getPos());if(o)return}var s=n.getNode();if(!this.hoveredNode&&!s)return;if(s.hovered)return;s&&!s.selected?(this.fx.nodeFxAnimation.stopTimer(),this.viz.graph.eachNode(function(e){if(e.hovered&&!e.selected){for(var t in i)e.setData(t,e.styles["$"+t],"end");delete e.hovered}}),s.hovered=!0,this.hoveredNode=s,this.toggleStylesOnHover(s,!0)):this.hoveredNode&&!this.hoveredNode.selected&&(this.fx.nodeFxAnimation.stopTimer(),this.toggleStylesOnHover(this.hoveredNode,!1),delete this.hoveredNode.hovered,this.hoveredNode=!1)}}}}),h.Classes.Navigation=new t({Implements:[o,s],initializePost:function(){this.pos=!1,this.pressed=!1},onMouseWheel:function(t,n,i){if(this.config.zooming){e.event.stop(e.event.get(t,n));var a=this.config.zooming/1e3,o=1+i*a;this.canvas.scale(o,o)}},onMouseDown:function(e,t,n){if(this.config.panning&&("avoid nodes"!=this.config.panning||(this.dom?!this.isLabel(e,t):!n.getNode()))){this.pressed=!0,this.pos=n.getPos();var i=this.canvas,a=i.translateOffsetX,o=i.translateOffsetY,s=i.scaleOffsetX,r=i.scaleOffsetY;this.pos.x*=s,this.pos.x+=a,this.pos.y*=r,this.pos.y+=o}},onMouseMove:function(e,t,n){if(this.config.panning&&this.pressed&&("avoid nodes"!=this.config.panning||(this.dom?!this.isLabel(e,t):!n.getNode()))){var i=this.pos,a=n.getPos(),o=this.canvas,s=o.translateOffsetX,r=o.translateOffsetY,h=o.scaleOffsetX,l=o.scaleOffsetY;a.x*=h,a.y*=l,a.x+=s,a.y+=r;var c=a.x-i.x,d=a.y-i.y;this.pos=a,this.canvas.translate(1*c/h,1*d/l)}},onMouseUp:function(e,t,n,i){this.config.panning&&(this.pressed=!1)}});var l;!function(){function n(t,n){var i=document.createElement(t);for(var o in n)"object"==typeof n[o]?e.extend(i[o],n[o]):i[o]=n[o];return"canvas"==t&&!a&&G_vmlCanvasManager&&(i=G_vmlCanvasManager.initElement(document.body.appendChild(i))),i}var i=typeof HTMLCanvasElement,a="object"==i||"function"==i;$jit.Canvas=l=new t({canvases:[],pos:!1,element:!1,labelContainer:!1,translateOffsetX:0,translateOffsetY:0,scaleOffsetX:1,scaleOffsetY:1,initialize:function(t,i){this.viz=t,this.opt=this.config=i;var a="string"==e.type(i.injectInto)?i.injectInto:i.injectInto.id,o=i.type,s=a+"-label",r=e(a),h=i.width||r.offsetWidth,c=i.height||r.offsetHeight;this.id=a;var d={injectInto:a,width:h,height:c};this.element=n("div",{id:a+"-canvaswidget",style:{position:"relative",width:h+"px",height:c+"px"}}),this.labelContainer=this.createLabelContainer(i.Label.type,s,d),this.canvases.push(new l.Base[o]({config:e.extend({idSuffix:"-canvas"},d),plot:function(e){t.fx.plot()},resize:function(){t.refresh()}}));var u=i.background;if(u){var f=new l.Background[u.type](t,e.extend(u,d));this.canvases.push(new l.Base[o](f))}for(var g=this.canvases.length;g--;)this.element.appendChild(this.canvases[g].canvas),g>0&&this.canvases[g].plot();this.element.appendChild(this.labelContainer),r.appendChild(this.element);var p=null,v=this;e.addEvent(window,"scroll",function(){clearTimeout(p),p=setTimeout(function(){v.getPos(!0)},500)})},getCtx:function(e){return this.canvases[e||0].getCtx()},getConfig:function(){return this.opt},getElement:function(){return this.element},getSize:function(e){return this.canvases[e||0].getSize()},resize:function(e,t){this.getPos(!0),this.translateOffsetX=this.translateOffsetY=0,this.scaleOffsetX=this.scaleOffsetY=1;for(var n=0,i=this.canvases.length;i>n;n++)this.canvases[n].resize(e,t);var a=this.element.style;a.width=e+"px",a.height=t+"px",this.labelContainer&&(this.labelContainer.style.width=e+"px")},translate:function(e,t,n){this.translateOffsetX+=e*this.scaleOffsetX,this.translateOffsetY+=t*this.scaleOffsetY;for(var i=0,a=this.canvases.length;a>i;i++)this.canvases[i].translate(e,t,n)},scale:function(e,t,n){var i=this.scaleOffsetX*e,a=this.scaleOffsetY*t,o=this.translateOffsetX*(e-1)/i,s=this.translateOffsetY*(t-1)/a;this.scaleOffsetX=i,this.scaleOffsetY=a;for(var r=0,h=this.canvases.length;h>r;r++)this.canvases[r].scale(e,t,!0);this.translate(o,s,!1)},getPos:function(t){return t||!this.pos?this.pos=e.getPos(this.getElement()):this.pos},clear:function(e){this.canvases[e||0].clear()},path:function(e,t){var n=this.canvases[0].getCtx();n.beginPath(),t(n),n[e](),n.closePath()},createLabelContainer:function(e,t,i){var a="http://www.w3.org/2000/svg";if("HTML"==e||"Native"==e)return n("div",{id:t,style:{overflow:"visible",position:"absolute",top:0,left:0,width:i.width+"px",height:0}});if("SVG"==e){var o=document.createElementNS(a,"svg:svg");o.setAttribute("width",i.width),o.setAttribute("height",i.height);var s=o.style;s.position="absolute",s.left=s.top="0px";var r=document.createElementNS(a,"svg:g");return r.setAttribute("width",i.width),r.setAttribute("height",i.height),r.setAttribute("x",0),r.setAttribute("y",0),r.setAttribute("id",t),o.appendChild(r),o}}}),l.Base={},l.Base["2D"]=new t({translateOffsetX:0,translateOffsetY:0,scaleOffsetX:1,scaleOffsetY:1,initialize:function(e){this.viz=e,this.opt=e.config,this.size=!1,this.createCanvas(),this.translateToCenter()},createCanvas:function(){var e=this.opt,t=e.width,i=e.height;this.canvas=n("canvas",{id:e.injectInto+e.idSuffix,width:t,height:i,style:{position:"absolute",top:0,left:0,width:t+"px",height:i+"px"}})},getCtx:function(){return this.ctx?this.ctx:this.ctx=this.canvas.getContext("2d")},getSize:function(){if(this.size)return this.size;var e=this.canvas;return this.size={width:e.width,height:e.height}},translateToCenter:function(e){var t=this.getSize(),n=e?t.width-e.width-2*this.translateOffsetX:t.width;height=e?t.height-e.height-2*this.translateOffsetY:t.height;var i=this.getCtx();e&&i.scale(1/this.scaleOffsetX,1/this.scaleOffsetY),i.translate(n/2,height/2)},resize:function(e,t){var n=this.getSize(),i=this.canvas,o=i.style;this.size=!1,i.width=e,i.height=t,o.width=e+"px",o.height=t+"px",a?this.translateToCenter():this.translateToCenter(n),this.translateOffsetX=this.translateOffsetY=0,this.scaleOffsetX=this.scaleOffsetY=1,this.clear(),this.viz.resize(e,t,this)},translate:function(e,t,n){var i=this.scaleOffsetX,a=this.scaleOffsetY;this.translateOffsetX+=e*i,this.translateOffsetY+=t*a,this.getCtx().translate(e,t),!n&&this.plot()},scale:function(e,t,n){this.scaleOffsetX*=e,this.scaleOffsetY*=t,this.getCtx().scale(e,t),!n&&this.plot()},clear:function(){var e=this.getSize(),t=this.translateOffsetX,n=this.translateOffsetY,i=this.scaleOffsetX,a=this.scaleOffsetY;this.getCtx().clearRect(1*(-e.width/2-t)/i,1*(-e.height/2-n)/a,1*e.width/i,1*e.height/a)},plot:function(){this.clear(),this.viz.plot(this)}}),l.Background={},l.Background.Circles=new t({initialize:function(t,n){this.viz=t,this.config=e.merge({idSuffix:"-bkcanvas",levelDistance:200,numberOfCircles:10,CanvasStyles:{},offset:0},n)},resize:function(e,t,n){this.plot(n)},plot:function(e){var t=(e.canvas,e.getCtx()),n=this.config,i=n.CanvasStyles;for(var a in i)t[a]=i[a];for(var o=n.numberOfCircles,s=n.levelDistance,r=1;o>=r;r++)t.beginPath(),t.arc(0,0,s*r,0,2*Math.PI,!1),t.stroke(),t.closePath()}})}();var c=function(e,t){this.theta=e||0,this.rho=t||0};$jit.Polar=c,c.prototype={getc:function(e){return this.toComplex(e)},getp:function(){return this},set:function(e){e=e.getp(),this.theta=e.theta,this.rho=e.rho},setc:function(e,t){this.rho=Math.sqrt(e*e+t*t),this.theta=Math.atan2(t,e),this.theta<0&&(this.theta+=2*Math.PI)},setp:function(e,t){this.theta=e,this.rho=t},clone:function(){return new c(this.theta,this.rho)},toComplex:function(e){var t=Math.cos(this.theta)*this.rho,n=Math.sin(this.theta)*this.rho;return e?{x:t,y:n}:new u(t,n)},add:function(e){return new c(this.theta+e.theta,this.rho+e.rho)},scale:function(e){return new c(this.theta,this.rho*e)},equals:function(e){return this.theta==e.theta&&this.rho==e.rho},$add:function(e){return this.theta=this.theta+e.theta,this.rho+=e.rho,this},$madd:function(e){return this.theta=(this.theta+e.theta)%(2*Math.PI),this.rho+=e.rho,this},$scale:function(e){return this.rho*=e,this},isZero:function(){var e=1e-4,t=Math.abs;return t(this.theta)<e&&t(this.rho)<e},interpolate:function(e,t){var n,i=Math.PI,a=2*i,o=function(e){var t=0>e?e%a+a:e%a;return t},s=this.theta,r=e.theta,h=Math.abs(s-r);n=o(h==i?s>r?r+(s-a-r)*t:r-a+(s-r)*t:h>=i?s>r?r+(s-a-r)*t:r-a+(s-(r-a))*t:r+(s-r)*t);var l=(this.rho-e.rho)*t+e.rho;return{theta:n,rho:l}}};var d=function(e,t){return new c(e,t)};c.KER=d(0,0);var u=function(e,t){this.x=e||0,this.y=t||0};$jit.Complex=u,u.prototype={getc:function(){return this},getp:function(e){return this.toPolar(e)},set:function(e){e=e.getc(!0),this.x=e.x,this.y=e.y},setc:function(e,t){this.x=e,this.y=t},setp:function(e,t){this.x=Math.cos(e)*t,this.y=Math.sin(e)*t},clone:function(){return new u(this.x,this.y)},toPolar:function(e){var t=this.norm(),n=Math.atan2(this.y,this.x);return 0>n&&(n+=2*Math.PI),e?{theta:n,rho:t}:new c(n,t)},norm:function(){return Math.sqrt(this.squaredNorm())},squaredNorm:function(){return this.x*this.x+this.y*this.y},add:function(e){return new u(this.x+e.x,this.y+e.y)},prod:function(e){return new u(this.x*e.x-this.y*e.y,this.y*e.x+this.x*e.y)},conjugate:function(){return new u(this.x,-this.y)},scale:function(e){return new u(this.x*e,this.y*e)},equals:function(e){return this.x==e.x&&this.y==e.y},$add:function(e){return this.x+=e.x,this.y+=e.y,this},$prod:function(e){var t=this.x,n=this.y;return this.x=t*e.x-n*e.y,this.y=n*e.x+t*e.y,this},$conjugate:function(){return this.y=-this.y,this},$scale:function(e){return this.x*=e,this.y*=e,this},$div:function(e){var t=this.x,n=this.y,i=e.squaredNorm();return this.x=t*e.x+n*e.y,this.y=n*e.x-t*e.y,this.$scale(1/i)},isZero:function(){var e=1e-4,t=Math.abs;return t(this.x)<e&&t(this.y)<e}};var f=function(e,t){return new u(e,t)};u.KER=f(0,0),$jit.Graph=new t({initialize:function(t,n,i,a){var o={klass:u,Node:{}};this.Node=n,this.Edge=i,this.Label=a,this.opt=e.merge(o,t||{}),this.nodes={},this.edges={};var s=this;this.nodeList={};for(var r in g)s.nodeList[r]=function(e){return function(){var t=Array.prototype.slice.call(arguments);s.eachNode(function(n){n[e].apply(n,t)})}}(r)},getNode:function(e){return this.hasNode(e)?this.nodes[e]:!1},get:function(e){return this.getNode(e)},getByName:function(e){for(var t in this.nodes){var n=this.nodes[t];if(n.name==e)return n}return!1},getAdjacence:function(e,t){return e in this.edges?this.edges[e][t]:!1},addNode:function(t){if(!this.nodes[t.id]){var n=this.edges[t.id]={};this.nodes[t.id]=new p.Node(e.extend({id:t.id,name:t.name,data:e.merge(t.data||{},{}),adjacencies:n},this.opt.Node),this.opt.klass,this.Node,this.Edge,this.Label)}return this.nodes[t.id]},addAdjacence:function(e,t,n){if(this.hasNode(e.id)||this.addNode(e),this.hasNode(t.id)||this.addNode(t),e=this.nodes[e.id],t=this.nodes[t.id],!e.adjacentTo(t)){var i=this.edges[e.id]=this.edges[e.id]||{},a=this.edges[t.id]=this.edges[t.id]||{};return i[t.id]=a[e.id]=new p.Adjacence(e,t,n,this.Edge,this.Label),i[t.id]}return this.edges[e.id][t.id]},removeNode:function(e){if(this.hasNode(e)){delete this.nodes[e];var t=this.edges[e];for(var n in t)delete this.edges[n][e];delete this.edges[e]}},removeAdjacence:function(e,t){delete this.edges[e][t],delete this.edges[t][e]},hasNode:function(e){return e in this.nodes},empty:function(){this.nodes={},this.edges={}}});var g,p=$jit.Graph;!function(){var t=function(e,t,n,i,a){var o;n=n||"current",e="$"+(e?e+"-":""),"current"==n?o=this.data:"start"==n?o=this.startData:"end"==n&&(o=this.endData);var s=e+t;return i?o[s]:this.Config.overridable?s in o?o[s]:s in this.data?this.data[s]:a[t]||0:a[t]||0},n=function(e,t,n,i){i=i||"current",e="$"+(e?e+"-":"");var a;"current"==i?a=this.data:"start"==i?a=this.startData:"end"==i&&(a=this.endData),a[e+t]=n},i=function(t,n){t="$"+(t?t+"-":"");var i=this;e.each(n,function(e){var n=t+e;delete i.data[n],delete i.endData[n],delete i.startData[n]})};g={getData:function(e,n,i){return t.call(this,"",e,n,i,this.Config)},setData:function(e,t,i){n.call(this,"",e,t,i)},setDataset:function(t,n){t=e.splat(t);for(var i in n)for(var a=0,o=e.splat(n[i]),s=t.length;s>a;a++)this.setData(i,o[a],t[a])},removeData:function(){i.call(this,"",Array.prototype.slice.call(arguments))},getCanvasStyle:function(e,n,i){return t.call(this,"canvas",e,n,i,this.Config.CanvasStyles)},setCanvasStyle:function(e,t,i){n.call(this,"canvas",e,t,i)},setCanvasStyles:function(t,n){t=e.splat(t);for(var i in n)for(var a=0,o=e.splat(n[i]),s=t.length;s>a;a++)this.setCanvasStyle(i,o[a],t[a])},removeCanvasStyle:function(){i.call(this,"canvas",Array.prototype.slice.call(arguments));
},getLabelData:function(e,n,i){return t.call(this,"label",e,n,i,this.Label)},setLabelData:function(e,t,i){n.call(this,"label",e,t,i)},setLabelDataset:function(t,n){t=e.splat(t);for(var i in n)for(var a=0,o=e.splat(n[i]),s=t.length;s>a;a++)this.setLabelData(i,o[a],t[a])},removeLabelData:function(){i.call(this,"label",Array.prototype.slice.call(arguments))}}}(),p.Node=new t({initialize:function(t,n,i,a,o){var s={id:"",name:"",data:{},startData:{},endData:{},adjacencies:{},selected:!1,drawn:!1,exist:!1,angleSpan:{begin:0,end:0},pos:new n,startPos:new n,endPos:new n};e.extend(this,e.extend(s,t)),this.Config=this.Node=i,this.Edge=a,this.Label=o},adjacentTo:function(e){return e.id in this.adjacencies},getAdjacency:function(e){return this.adjacencies[e]},getPos:function(e){return e=e||"current","current"==e?this.pos:"end"==e?this.endPos:"start"==e?this.startPos:void 0},setPos:function(e,t){t=t||"current";var n;"current"==t?n=this.pos:"end"==t?n=this.endPos:"start"==t&&(n=this.startPos),n.set(e)}}),p.Node.implement(g),p.Adjacence=new t({initialize:function(e,t,n,i,a){this.nodeFrom=e,this.nodeTo=t,this.data=n||{},this.startData={},this.endData={},this.Config=this.Edge=i,this.Label=a}}),p.Adjacence.implement(g),p.Util={filter:function(t){if(!t||"string"!=e.type(t))return function(){return!0};var n=t.split(" ");return function(e){for(var t=0;t<n.length;t++)if(e[n[t]])return!1;return!0}},getNode:function(e,t){return e.nodes[t]},eachNode:function(e,t,n){var i=this.filter(n);for(var a in e.nodes)i(e.nodes[a])&&t(e.nodes[a])},each:function(e,t,n){this.eachNode(e,t,n)},eachAdjacency:function(e,t,n){var i=e.adjacencies,a=this.filter(n);for(var o in i){var s=i[o];if(a(s)){if(s.nodeFrom!=e){var r=s.nodeFrom;s.nodeFrom=s.nodeTo,s.nodeTo=r}t(s,o)}}},computeLevels:function(e,t,n,i){n=n||0;var a=this.filter(i);this.eachNode(e,function(e){e._flag=!1,e._depth=-1},i);var o=e.getNode(t);o._depth=n;for(var s=[o];0!=s.length;){var r=s.pop();r._flag=!0,this.eachAdjacency(r,function(e){var t=e.nodeTo;0==t._flag&&a(t)&&(t._depth<0&&(t._depth=r._depth+1+n),s.unshift(t))},i)}},eachBFS:function(e,t,n,i){var a=this.filter(i);this.clean(e);for(var o=[e.getNode(t)];0!=o.length;){var s=o.pop();s._flag=!0,n(s,s._depth),this.eachAdjacency(s,function(e){var t=e.nodeTo;0==t._flag&&a(t)&&(t._flag=!0,o.unshift(t))},i)}},eachLevel:function(e,t,n,i,a){var o=e._depth,s=this.filter(a),r=this;n=n===!1?Number.MAX_VALUE-o:n,function h(e,t,n){var a=e._depth;a>=t&&n>=a&&s(e)&&i(e,a),n>a&&r.eachAdjacency(e,function(e){var i=e.nodeTo;i._depth>a&&h(i,t,n)})}(e,t+o,n+o)},eachSubgraph:function(e,t,n){this.eachLevel(e,0,!1,t,n)},eachSubnode:function(e,t,n){this.eachLevel(e,1,1,t,n)},anySubnode:function(t,n,i){var a=!1;n=n||e.lambda(!0);var o="string"==e.type(n)?function(e){return e[n]}:n;return this.eachSubnode(t,function(e){o(e)&&(a=!0)},i),a},getSubnodes:function(t,n,i){var a=[];n=n||0;var o,s;return"array"==e.type(n)?(o=n[0],s=n[1]):(o=n,s=Number.MAX_VALUE-t._depth),this.eachLevel(t,o,s,function(e){a.push(e)},i),a},getParents:function(e){var t=[];return this.eachAdjacency(e,function(n){var i=n.nodeTo;i._depth<e._depth&&t.push(i)}),t},isDescendantOf:function(e,t){if(e.id==t)return!0;for(var n=this.getParents(e),i=!1,a=0;!i&&a<n.length;a++)i=i||this.isDescendantOf(n[a],t);return i},clean:function(e){this.eachNode(e,function(e){e._flag=!1})},getClosestNodeToOrigin:function(e,t,n){return this.getClosestNodeToPos(e,c.KER,t,n)},getClosestNodeToPos:function(e,t,n,i){var a=null;n=n||"current",t=t&&t.getc(!0)||u.KER;var o=function(e,t){var n=e.x-t.x,i=e.y-t.y;return n*n+i*i};return this.eachNode(e,function(e){a=null==a||o(e.getPos(n).getc(!0),t)<o(a.getPos(n).getc(!0),t)?e:a},i),a}},e.each(["get","getNode","each","eachNode","computeLevels","eachBFS","clean","getClosestNodeToPos","getClosestNodeToOrigin"],function(e){p.prototype[e]=function(){return p.Util[e].apply(p.Util,[this].concat(Array.prototype.slice.call(arguments)))}}),e.each(["eachAdjacency","eachLevel","eachSubgraph","eachSubnode","anySubnode","getSubnodes","getParents","isDescendantOf"],function(e){p.Node.prototype[e]=function(){return p.Util[e].apply(p.Util,[this].concat(Array.prototype.slice.call(arguments)))}}),p.Op={options:{type:"nothing",duration:2e3,hideLabels:!0,fps:30},initialize:function(e){this.viz=e},removeNode:function(t,n){var i,a,o,s=this.viz,r=e.merge(this.options,s.controller,n),h=e.splat(t);switch(r.type){case"nothing":for(i=0;i<h.length;i++)s.graph.removeNode(h[i]);break;case"replot":this.removeNode(h,{type:"nothing"}),s.labels.clearLabels(),s.refresh(!0);break;case"fade:seq":case"fade":for(a=this,i=0;i<h.length;i++)o=s.graph.getNode(h[i]),o.setData("alpha",0,"end");s.fx.animate(e.merge(r,{modes:["node-property:alpha"],onComplete:function(){a.removeNode(h,{type:"nothing"}),s.labels.clearLabels(),s.reposition(),s.fx.animate(e.merge(r,{modes:["linear"]}))}}));break;case"fade:con":for(a=this,i=0;i<h.length;i++)o=s.graph.getNode(h[i]),o.setData("alpha",0,"end"),o.ignore=!0;s.reposition(),s.fx.animate(e.merge(r,{modes:["node-property:alpha","linear"],onComplete:function(){a.removeNode(h,{type:"nothing"}),r.onComplete&&r.onComplete()}}));break;case"iter":a=this,s.fx.sequence({condition:function(){return 0!=h.length},step:function(){a.removeNode(h.shift(),{type:"nothing"}),s.labels.clearLabels()},onComplete:function(){r.onComplete&&r.onComplete()},duration:Math.ceil(r.duration/h.length)});break;default:this.doError()}},removeEdge:function(t,n){var i,a,o,s=this.viz,r=e.merge(this.options,s.controller,n),h="string"==e.type(t[0])?[t]:t;switch(r.type){case"nothing":for(i=0;i<h.length;i++)s.graph.removeAdjacence(h[i][0],h[i][1]);break;case"replot":this.removeEdge(h,{type:"nothing"}),s.refresh(!0);break;case"fade:seq":case"fade":for(a=this,i=0;i<h.length;i++)o=s.graph.getAdjacence(h[i][0],h[i][1]),o&&o.setData("alpha",0,"end");s.fx.animate(e.merge(r,{modes:["edge-property:alpha"],onComplete:function(){a.removeEdge(h,{type:"nothing"}),s.reposition(),s.fx.animate(e.merge(r,{modes:["linear"]}))}}));break;case"fade:con":for(a=this,i=0;i<h.length;i++)o=s.graph.getAdjacence(h[i][0],h[i][1]),o&&(o.setData("alpha",0,"end"),o.ignore=!0);s.reposition(),s.fx.animate(e.merge(r,{modes:["edge-property:alpha","linear"],onComplete:function(){a.removeEdge(h,{type:"nothing"}),r.onComplete&&r.onComplete()}}));break;case"iter":a=this,s.fx.sequence({condition:function(){return 0!=h.length},step:function(){a.removeEdge(h.shift(),{type:"nothing"}),s.labels.clearLabels()},onComplete:function(){r.onComplete()},duration:Math.ceil(r.duration/h.length)});break;default:this.doError()}},sum:function(t,n){var i,a=this.viz,o=e.merge(this.options,a.controller,n),s=a.root;switch(a.root=n.id||a.root,o.type){case"nothing":i=a.construct(t),i.eachNode(function(e){e.eachAdjacency(function(e){a.graph.addAdjacence(e.nodeFrom,e.nodeTo,e.data)})});break;case"replot":a.refresh(!0),this.sum(t,{type:"nothing"}),a.refresh(!0);break;case"fade:seq":case"fade":case"fade:con":that=this,i=a.construct(t);var r=this.preprocessSum(i),h=r?["node-property:alpha","edge-property:alpha"]:["node-property:alpha"];a.reposition(),"fade:con"!=o.type?a.fx.animate(e.merge(o,{modes:["linear"],onComplete:function(){a.fx.animate(e.merge(o,{modes:h,onComplete:function(){o.onComplete()}}))}})):(a.graph.eachNode(function(e){e.id!=s&&e.pos.isZero()&&(e.pos.set(e.endPos),e.startPos.set(e.endPos))}),a.fx.animate(e.merge(o,{modes:["linear"].concat(h)})));break;default:this.doError()}},morph:function(t,n,i){i=i||{};var a,o=this.viz,s=e.merge(this.options,o.controller,n),r=o.root;switch(o.root=n.id||o.root,s.type){case"nothing":a=o.construct(t),a.eachNode(function(e){var t=o.graph.hasNode(e.id);if(e.eachAdjacency(function(e){var t=!!o.graph.getAdjacence(e.nodeFrom.id,e.nodeTo.id);if(o.graph.addAdjacence(e.nodeFrom,e.nodeTo,e.data),t){var n=o.graph.getAdjacence(e.nodeFrom.id,e.nodeTo.id);for(var i in e.data||{})n.data[i]=e.data[i]}}),t){var n=o.graph.getNode(e.id);for(var i in e.data||{})n.data[i]=e.data[i]}}),o.graph.eachNode(function(e){e.eachAdjacency(function(e){a.getAdjacence(e.nodeFrom.id,e.nodeTo.id)||o.graph.removeAdjacence(e.nodeFrom.id,e.nodeTo.id)}),a.hasNode(e.id)||o.graph.removeNode(e.id)});break;case"replot":o.labels.clearLabels(!0),this.morph(t,{type:"nothing"}),o.refresh(!0),o.refresh(!0);break;case"fade:seq":case"fade":case"fade:con":that=this,a=o.construct(t);var h="node-property"in i&&e.map(e.splat(i["node-property"]),function(e){return"$"+e});o.graph.eachNode(function(t){var n=a.getNode(t.id);if(n){var i=n.data;for(var o in i)h&&e.indexOf(h,o)>-1?t.endData[o]=i[o]:t.data[o]=i[o]}else t.setData("alpha",1),t.setData("alpha",1,"start"),t.setData("alpha",0,"end"),t.ignore=!0}),o.graph.eachNode(function(e){e.ignore||e.eachAdjacency(function(e){if(!e.nodeFrom.ignore&&!e.nodeTo.ignore){var t=a.getNode(e.nodeFrom.id),n=a.getNode(e.nodeTo.id);if(!t.adjacentTo(n)){var e=o.graph.getAdjacence(t.id,n.id);l=!0,e.setData("alpha",1),e.setData("alpha",1,"start"),e.setData("alpha",0,"end")}}})});var l=this.preprocessSum(a),d=l?["node-property:alpha","edge-property:alpha"]:["node-property:alpha"];d[0]=d[0]+("node-property"in i?":"+e.splat(i["node-property"]).join(":"):""),d[1]=(d[1]||"edge-property:alpha")+("edge-property"in i?":"+e.splat(i["edge-property"]).join(":"):""),"label-property"in i&&d.push("label-property:"+e.splat(i["label-property"]).join(":")),o.reposition?o.reposition():o.compute("end"),o.graph.eachNode(function(e){e.id!=r&&e.pos.getp().equals(c.KER)&&(e.pos.set(e.endPos),e.startPos.set(e.endPos))}),o.fx.animate(e.merge(s,{modes:[i.position||"polar"].concat(d),onComplete:function(){o.graph.eachNode(function(e){e.ignore&&o.graph.removeNode(e.id)}),o.graph.eachNode(function(e){e.eachAdjacency(function(e){e.ignore&&o.graph.removeAdjacence(e.nodeFrom.id,e.nodeTo.id)})}),s.onComplete()}}))}},contract:function(t,n){var i=this.viz;!t.collapsed&&t.anySubnode(e.lambda(!0))&&(n=e.merge(this.options,i.config,n||{},{modes:["node-property:alpha:span","linear"]}),t.collapsed=!0,function a(e){e.eachSubnode(function(e){e.ignore=!0,e.setData("alpha",0,"animate"==n.type?"end":"current"),a(e)})}(t),"animate"==n.type?(i.compute("end"),i.rotated&&i.rotate(i.rotated,"none",{property:"end"}),function o(e){e.eachSubnode(function(e){e.setPos(t.getPos("end"),"end"),o(e)})}(t),i.fx.animate(n)):"replot"==n.type&&i.refresh())},expand:function(t,n){if("collapsed"in t){var i=this.viz;n=e.merge(this.options,i.config,n||{},{modes:["node-property:alpha:span","linear"]}),delete t.collapsed,function a(e){e.eachSubnode(function(e){delete e.ignore,e.setData("alpha",1,"animate"==n.type?"end":"current"),a(e)})}(t),"animate"==n.type?(i.compute("end"),i.rotated&&i.rotate(i.rotated,"none",{property:"end"}),i.fx.animate(n)):"replot"==n.type&&i.refresh()}},preprocessSum:function(e){var t=this.viz;e.eachNode(function(e){if(!t.graph.hasNode(e.id)){t.graph.addNode(e);var n=t.graph.getNode(e.id);n.setData("alpha",0),n.setData("alpha",0,"start"),n.setData("alpha",1,"end")}});var n=!1;return e.eachNode(function(e){e.eachAdjacency(function(e){var i=t.graph.getNode(e.nodeFrom.id),a=t.graph.getNode(e.nodeTo.id);if(!i.adjacentTo(a)){var e=t.graph.addAdjacence(i,a,e.data);i.startAlpha==i.endAlpha&&a.startAlpha==a.endAlpha&&(n=!0,e.setData("alpha",0),e.setData("alpha",0,"start"),e.setData("alpha",1,"end"))}})}),n}};var v={none:{render:e.empty,contains:e.lambda(!1)},circle:{render:function(e,t,n,i){var a=i.getCtx();a.beginPath(),a.arc(t.x,t.y,n,0,2*Math.PI,!0),a.closePath(),a[e]()},contains:function(e,t,n){var i=e.x-t.x,a=e.y-t.y,o=i*i+a*a;return n*n>=o}},ellipse:{render:function(e,t,n,i,a){var o=a.getCtx(),s=1,r=1,h=1,l=1,c=0;n>i?(c=n/2,r=i/n,l=n/i):(c=i/2,s=n/i,h=i/n),o.save(),o.scale(s,r),o.beginPath(),o.arc(t.x*h,t.y*l,c,0,2*Math.PI,!0),o.closePath(),o[e](),o.restore()},contains:function(e,t,n,i){var a=0,o=1,s=1,r=0,h=0,l=0;return n>i?(a=n/2,s=i/n):(a=i/2,o=n/i),r=(e.x-t.x)*(1/o),h=(e.y-t.y)*(1/s),l=r*r+h*h,a*a>=l}},square:{render:function(e,t,n,i){i.getCtx()[e+"Rect"](t.x-n,t.y-n,2*n,2*n)},contains:function(e,t,n){return Math.abs(t.x-e.x)<=n&&Math.abs(t.y-e.y)<=n}},rectangle:{render:function(e,t,n,i,a){a.getCtx()[e+"Rect"](t.x-n/2,t.y-i/2,n,i)},contains:function(e,t,n,i){return Math.abs(t.x-e.x)<=n/2&&Math.abs(t.y-e.y)<=i/2}},triangle:{render:function(e,t,n,i){var a=i.getCtx(),o=t.x,s=t.y-n,r=o-n,h=t.y+n,l=o+n,c=h;a.beginPath(),a.moveTo(o,s),a.lineTo(r,h),a.lineTo(l,c),a.closePath(),a[e]()},contains:function(e,t,n){return v.circle.contains(e,t,n)}},star:{render:function(e,t,n,i){var a=i.getCtx(),o=Math.PI/5;a.save(),a.translate(t.x,t.y),a.beginPath(),a.moveTo(n,0);for(var s=0;9>s;s++)a.rotate(o),s%2==0?a.lineTo(n/.525731*.200811,0):a.lineTo(n,0);a.closePath(),a[e](),a.restore()},contains:function(e,t,n){return v.circle.contains(e,t,n)}}},m={line:{render:function(e,t,n){var i=n.getCtx();i.beginPath(),i.moveTo(e.x,e.y),i.lineTo(t.x,t.y),i.stroke()},contains:function(e,t,n,i){var a=Math.min,o=Math.max,s=a(e.x,t.x),r=o(e.x,t.x),h=a(e.y,t.y),l=o(e.y,t.y);if(n.x>=s&&n.x<=r&&n.y>=h&&n.y<=l){if(Math.abs(t.x-e.x)<=i)return!0;var c=(t.y-e.y)/(t.x-e.x)*(n.x-e.x)+e.y;return Math.abs(c-n.y)<=i}return!1}},arrow:{render:function(e,t,n,i,a){var o=a.getCtx();if(i){var s=e;e=t,t=s}var r=new u(t.x-e.x,t.y-e.y);r.$scale(n/r.norm());var h=new u(t.x-r.x,t.y-r.y),l=new u(-r.y/2,r.x/2),c=h.add(l),d=h.$add(l.$scale(-1));o.beginPath(),o.moveTo(e.x,e.y),o.lineTo(t.x,t.y),o.stroke(),o.beginPath(),o.moveTo(c.x,c.y),o.lineTo(d.x,d.y),o.lineTo(t.x,t.y),o.closePath(),o.fill()},contains:function(e,t,n,i){return m.line.contains(e,t,n,i)}},hyperline:{render:function(e,t,n,i){function a(e,t){var n=e.x*t.y-e.y*t.x,i=n,a=e.squaredNorm(),o=t.squaredNorm();if(0==n)return{x:0,y:0,ratio:-1};var s=(e.y*o-t.y*a+e.y-t.y)/n,r=(t.x*a-e.x*o+t.x-e.x)/i,h=-s/2,l=-r/2,c=(s*s+r*r)/4-1;if(0>c)return{x:0,y:0,ratio:-1};var d=Math.sqrt(c),u={x:h,y:l,ratio:d>1e3?-1:d,a:s,b:r};return u}function o(e,t){return t>e?e+Math.PI>t?!1:!0:t+Math.PI>e?!0:!1}var s=i.getCtx(),r=a(e,t);if(r.a>1e3||r.b>1e3||r.ratio<0)s.beginPath(),s.moveTo(e.x*n,e.y*n),s.lineTo(t.x*n,t.y*n),s.stroke();else{var h=Math.atan2(t.y-r.y,t.x-r.x),l=Math.atan2(e.y-r.y,e.x-r.x),o=o(h,l);s.beginPath(),s.arc(r.x*n,r.y*n,r.ratio*n,h,l,o),s.stroke()}},contains:e.lambda(!1)}};p.Plot={initialize:function(e,t){this.viz=e,this.config=e.config,this.node=e.config.Node,this.edge=e.config.Edge,this.animation=new i,this.nodeTypes=new t.Plot.NodeTypes,this.edgeTypes=new t.Plot.EdgeTypes,this.labels=e.labels},nodeHelper:v,edgeHelper:m,Interpolator:{map:{border:"color",color:"color",width:"number",height:"number",dim:"number",alpha:"number",lineWidth:"number",angularWidth:"number",span:"number",valueArray:"array-number",dimArray:"array-number"},canvas:{globalAlpha:"number",fillStyle:"color",strokeStyle:"color",lineWidth:"number",shadowBlur:"number",shadowColor:"color",shadowOffsetX:"number",shadowOffsetY:"number",miterLimit:"number"},label:{size:"number",color:"color"},compute:function(e,t,n){return e+(t-e)*n},moebius:function(e,t,n,i){var a=i.scale(-n);if(a.norm()<1){var o=a.x,s=a.y,r=e.startPos.getc().moebiusTransformation(a);e.pos.setc(r.x,r.y),a.x=o,a.y=s}},linear:function(e,t,n){var i=e.startPos.getc(!0),a=e.endPos.getc(!0);e.pos.setc(this.compute(i.x,a.x,n),this.compute(i.y,a.y,n))},polar:function(e,t,n){var i=e.startPos.getp(!0),a=e.endPos.getp(),o=a.interpolate(i,n);e.pos.setp(o.theta,o.rho)},number:function(e,t,n,i,a){var o=e[i](t,"start"),s=e[i](t,"end");e[a](t,this.compute(o,s,n))},color:function(t,n,i,a,o){var s=e.hexToRgb(t[a](n,"start")),r=e.hexToRgb(t[a](n,"end")),h=this.compute,l=e.rgbToHex([parseInt(h(s[0],r[0],i)),parseInt(h(s[1],r[1],i)),parseInt(h(s[2],r[2],i))]);t[o](n,l)},"array-number":function(e,t,n,i,a){for(var o=e[i](t,"start"),s=e[i](t,"end"),r=[],h=0,l=o.length;l>h;h++){var c=o[h],d=s[h];if(c.length){for(var u=0,f=c.length,g=[];f>u;u++)g.push(this.compute(c[u],d[u],n));r.push(g)}else r.push(this.compute(c,d,n))}e[a](t,r)},node:function(e,t,n,i,a,o){if(i=this[i],t)for(var s=t.length,r=0;s>r;r++){var h=t[r];this[i[h]](e,h,n,a,o)}else for(var h in i)this[i[h]](e,h,n,a,o)},edge:function(e,t,n,i,a,o){var s=e.adjacencies;for(var r in s)this.node(s[r],t,n,i,a,o)},"node-property":function(e,t,n){this.node(e,t,n,"map","getData","setData")},"edge-property":function(e,t,n){this.edge(e,t,n,"map","getData","setData")},"label-property":function(e,t,n){this.node(e,t,n,"label","getLabelData","setLabelData")},"node-style":function(e,t,n){this.node(e,t,n,"canvas","getCanvasStyle","setCanvasStyle")},"edge-style":function(e,t,n){this.edge(e,t,n,"canvas","getCanvasStyle","setCanvasStyle")}},sequence:function(t){var n=this;t=e.merge({condition:e.lambda(!1),step:e.empty,onComplete:e.empty,duration:200},t||{});var i=setInterval(function(){t.condition()?t.step():(clearInterval(i),t.onComplete()),n.viz.refresh(!0)},t.duration)},prepare:function(t){var n=this.viz.graph,i={"node-property":{getter:"getData",setter:"setData"},"edge-property":{getter:"getData",setter:"setData"},"node-style":{getter:"getCanvasStyle",setter:"setCanvasStyle"},"edge-style":{getter:"getCanvasStyle",setter:"setCanvasStyle"}},a={};if("array"==e.type(t))for(var o=0,s=t.length;s>o;o++){var r=t[o].split(":");a[r.shift()]=r}else for(var h in t)"position"==h?a[t.position]=[]:a[h]=e.splat(t[h]);return n.eachNode(function(t){t.startPos.set(t.pos),e.each(["node-property","node-style"],function(e){if(e in a)for(var n=a[e],o=0,s=n.length;s>o;o++)t[i[e].setter](n[o],t[i[e].getter](n[o]),"start")}),e.each(["edge-property","edge-style"],function(e){if(e in a){var n=a[e];t.eachAdjacency(function(t){for(var a=0,o=n.length;o>a;a++)t[i[e].setter](n[a],t[i[e].getter](n[a]),"start")})}})}),a},animate:function(t,n){t=e.merge(this.viz.config,t||{});var i=this,a=this.viz,o=a.graph,s=this.Interpolator,r="nodefx"===t.type?this.nodeFxAnimation:this.animation,h=this.prepare(t.modes);t.hideLabels&&this.labels.hideLabels(!0),r.setOptions(e.extend(t,{$animating:!1,compute:function(e){o.eachNode(function(t){for(var i in h)s[i](t,h[i],e,n)}),i.plot(t,this.$animating,e),this.$animating=!0},complete:function(){t.hideLabels&&i.labels.hideLabels(!1),i.plot(t),t.onComplete()}})).start()},nodeFx:function(t){var n=this.viz,i=n.graph,a=this.nodeFxAnimation,o=e.merge(this.viz.config,{elements:{id:!1,properties:{}},reposition:!1});t=e.merge(o,t||{},{onBeforeCompute:e.empty,onAfterCompute:e.empty}),a.stopTimer();var s=t.elements.properties;if(t.elements.id){var r=e.splat(t.elements.id);e.each(r,function(e){var t=i.getNode(e);if(t)for(var n in s)t.setData(n,s[n],"end")})}else i.eachNode(function(e){for(var t in s)e.setData(t,s[t],"end")});var h=[];for(var l in s)h.push(l);var c=["node-property:"+h.join(":")];t.reposition&&(c.push("linear"),n.compute("end")),this.animate(e.merge(t,{modes:c,type:"nodefx"}))},plot:function(e,t){var n=this.viz,i=n.graph,a=n.canvas,o=n.root,s=this,e=(a.getCtx(),Math.min,e||this.viz.controller);e.clearCanvas&&a.clear();var r=i.getNode(o);if(r){var h=!!r.visited;i.eachNode(function(n){var i=n.getData("alpha");n.eachAdjacency(function(i){var o=i.nodeTo;!!o.visited===h&&n.drawn&&o.drawn&&(!t&&e.onBeforePlotLine(i),s.plotLine(i,a,t),!t&&e.onAfterPlotLine(i))}),n.drawn&&(!t&&e.onBeforePlotNode(n),s.plotNode(n,a,t),!t&&e.onAfterPlotNode(n)),!s.labelsHidden&&e.withLabels&&(n.drawn&&i>=.95?s.labels.plotLabel(a,n,e):s.labels.hideLabel(n,!1)),n.visited=!h})}},plotTree:function(e,t,n){var i=this,a=this.viz,o=a.canvas,s=(this.config,o.getCtx(),e.getData("alpha"));e.eachSubnode(function(a){if(t.plotSubtree(e,a)&&a.exist&&a.drawn){var s=e.getAdjacency(a.id);!n&&t.onBeforePlotLine(s),i.plotLine(s,o,n),!n&&t.onAfterPlotLine(s),i.plotTree(a,t,n)}}),e.drawn?(!n&&t.onBeforePlotNode(e),this.plotNode(e,o,n),!n&&t.onAfterPlotNode(e),!t.hideLabels&&t.withLabels&&s>=.95?this.labels.plotLabel(o,e,t):this.labels.hideLabel(e,!1)):this.labels.hideLabel(e,!0)},plotNode:function(e,t,n){var i=e.getData("type"),a=this.node.CanvasStyles;if("none"!=i){var o=e.getData("lineWidth"),s=e.getData("color"),r=e.getData("alpha"),h=t.getCtx();h.save(),h.lineWidth=o,h.fillStyle=h.strokeStyle=s,h.globalAlpha=r;for(var l in a)h[l]=e.getCanvasStyle(l);this.nodeTypes[i].render.call(this,e,t,n),h.restore()}},plotLine:function(e,t,n){var i=e.getData("type"),a=this.edge.CanvasStyles;if("none"!=i){var o=e.getData("lineWidth"),s=e.getData("color"),r=t.getCtx(),h=e.nodeFrom,l=e.nodeTo;r.save(),r.lineWidth=o,r.fillStyle=r.strokeStyle=s,r.globalAlpha=Math.min(h.getData("alpha"),l.getData("alpha"),e.getData("alpha"));for(var c in a)r[c]=e.getCanvasStyle(c);this.edgeTypes[i].render.call(this,e,t,n),r.restore()}}},p.Plot3D=e.merge(p.Plot,{Interpolator:{linear:function(e,t,n){var i=e.startPos.getc(!0),a=e.endPos.getc(!0);e.pos.setc(this.compute(i.x,a.x,n),this.compute(i.y,a.y,n),this.compute(i.z,a.z,n))}},plotNode:function(e,t){"none"!=e.getData("type")&&this.plotElement(e,t,{getAlpha:function(){return e.getData("alpha")}})},plotLine:function(e,t){"none"!=e.getData("type")&&this.plotElement(e,t,{getAlpha:function(){return Math.min(e.nodeFrom.getData("alpha"),e.nodeTo.getData("alpha"),e.getData("alpha"))}})},plotElement:function(t,n,i){var a=n.getCtx(),o=new Matrix4,s=n.config.Scene.Lighting,r=n.canvases[0],h=r.program,l=r.camera;if(t.geometry||(t.geometry=new(O3D[t.getData("type")])),t.geometry.update(t),!t.webGLVertexBuffer){for(var c=[],d=[],u=[],f=0,g=t.geometry,p=0,v=g.vertices,m=g.faces,y=m.length;y>p;p++){var b=m[p],x=v[b.a],w=v[b.b],N=v[b.c],C=b.d?v[b.d]:!1,L=b.normal;c.push(x.x,x.y,x.z),c.push(w.x,w.y,w.z),c.push(N.x,N.y,N.z),C&&c.push(C.x,C.y,C.z),u.push(L.x,L.y,L.z),u.push(L.x,L.y,L.z),u.push(L.x,L.y,L.z),C&&u.push(L.x,L.y,L.z),d.push(f,f+1,f+2),C?(d.push(f,f+2,f+3),f+=4):f+=3}t.webGLVertexBuffer=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,t.webGLVertexBuffer),a.bufferData(a.ARRAY_BUFFER,new Float32Array(c),a.STATIC_DRAW),t.webGLFaceBuffer=a.createBuffer(),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,t.webGLFaceBuffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array(d),a.STATIC_DRAW),t.webGLFaceCount=d.length,t.webGLNormalBuffer=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,t.webGLNormalBuffer),a.bufferData(a.ARRAY_BUFFER,new Float32Array(u),a.STATIC_DRAW)}o.multiply(l.matrix,t.geometry.matrix),a.uniformMatrix4fv(h.viewMatrix,!1,o.flatten()),a.uniformMatrix4fv(h.projectionMatrix,!1,l.projectionMatrix.flatten());var D=Matrix4.makeInvert(o);D.$transpose(),a.uniformMatrix4fv(h.normalMatrix,!1,D.flatten());var S=e.hexToRgb(t.getData("color"));if(S.push(i.getAlpha()),a.uniform4f(h.color,S[0]/255,S[1]/255,S[2]/255,S[3]),a.uniform1i(h.enableLighting,s.enable),s.enable){if(s.ambient){var O=s.ambient;a.uniform3f(h.ambientColor,O[0],O[1],O[2])}if(s.directional){var M=s.directional,S=M.color,T=M.direction,P=new Vector3(T.x,T.y,T.z).normalize().$scale(-1);a.uniform3f(h.lightingDirection,P.x,P.y,P.z),a.uniform3f(h.directionalColor,S[0],S[1],S[2])}}a.bindBuffer(a.ARRAY_BUFFER,t.webGLVertexBuffer),a.vertexAttribPointer(h.position,3,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,t.webGLNormalBuffer),a.vertexAttribPointer(h.normal,3,a.FLOAT,!1,0,0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,t.webGLFaceBuffer),a.drawElements(a.TRIANGLES,t.webGLFaceCount,a.UNSIGNED_SHORT,0)}}),p.Label={},p.Label.Native=new t({initialize:function(e){this.viz=e},plotLabel:function(e,t,n){var i=e.getCtx();t.pos.getc(!0);i.font=t.getLabelData("style")+" "+t.getLabelData("size")+"px "+t.getLabelData("family"),i.textAlign=t.getLabelData("textAlign"),i.fillStyle=i.strokeStyle=t.getLabelData("color"),i.textBaseline=t.getLabelData("textBaseline"),this.renderLabel(e,t,n)},renderLabel:function(e,t,n){var i=e.getCtx(),a=t.pos.getc(!0);i.fillText(t.name,a.x,a.y+t.getData("height")/2)},hideLabel:e.empty,hideLabels:e.empty}),p.Label.DOM=new t({labelsHidden:!1,labelContainer:!1,labels:{},getLabelContainer:function(){return this.labelContainer?this.labelContainer:this.labelContainer=document.getElementById(this.viz.config.labelContainer)},getLabel:function(e){return e in this.labels&&null!=this.labels[e]?this.labels[e]:this.labels[e]=document.getElementById(e)},hideLabels:function(e){var t=this.getLabelContainer();e?t.style.display="none":t.style.display="",this.labelsHidden=e},clearLabels:function(e){for(var t in this.labels)(e||!this.viz.graph.hasNode(t))&&(this.disposeLabel(t),delete this.labels[t])},disposeLabel:function(e){var t=this.getLabel(e);t&&t.parentNode&&t.parentNode.removeChild(t)},hideLabel:function(t,n){t=e.splat(t);var i=n?"":"none",a=this;e.each(t,function(e){var t=a.getLabel(e.id);t&&(t.style.display=i)})},fitsInCanvas:function(e,t){var n=t.getSize();return e.x>=n.width||e.x<0||e.y>=n.height||e.y<0?!1:!0}}),p.Label.HTML=new t({Implements:p.Label.DOM,plotLabel:function(e,t,n){var i=t.id,a=this.getLabel(i);if(!a&&!(a=document.getElementById(i))){a=document.createElement("div");var o=this.getLabelContainer();a.id=i,a.className="node",a.style.position="absolute",n.onCreateLabel(a,t),o.appendChild(a),this.labels[t.id]=a}this.placeLabel(a,t,n)}}),p.Label.SVG=new t({Implements:p.Label.DOM,plotLabel:function(e,t,n){var i=t.id,a=this.getLabel(i);if(!a&&!(a=document.getElementById(i))){var o="http://www.w3.org/2000/svg";a=document.createElementNS(o,"svg:text");var s=document.createElementNS(o,"svg:tspan");a.appendChild(s);var r=this.getLabelContainer();a.setAttribute("id",i),a.setAttribute("class","node"),r.appendChild(a),n.onCreateLabel(a,t),this.labels[t.id]=a}this.placeLabel(a,t,n)}}),p.Geom=new t({initialize:function(e){this.viz=e,this.config=e.config,this.node=e.config.Node,this.edge=e.config.Edge},translate:function(t,n){n=e.splat(n),this.viz.graph.eachNode(function(i){e.each(n,function(e){i.getPos(e).$add(t)})})},setRightLevelToShow:function(t,n,i){var a=this.getRightLevelToShow(t,n),o=this.viz.labels,s=e.merge({execShow:!0,execHide:!0,onHide:e.empty,onShow:e.empty},i||{});t.eachLevel(0,this.config.levelsToShow,function(e){var n=e._depth-t._depth;n>a?(s.onHide(e),s.execHide&&(e.drawn=!1,e.exist=!1,o.hideLabel(e,!1))):(s.onShow(e),s.execShow&&(e.exist=!0))}),t.drawn=!0},getRightLevelToShow:function(e,t){var n=this.config,i=n.levelsToShow,a=n.constrained;if(!a)return i;for(;!this.treeFitsInCanvas(e,t,i)&&i>1;)i--;return i}});var y={construct:function(t){var n="array"==e.type(t),i=new p(this.graphOptions,this.config.Node,this.config.Edge,this.config.Label);return n?function(t,n){for(var i=function(e){for(var i=0,a=n.length;a>i;i++)if(n[i].id==e)return n[i];var o={id:e,name:e};return t.addNode(o)},a=0,o=n.length;o>a;a++){t.addNode(n[a]);var s=n[a].adjacencies;if(s)for(var r=0,h=s.length;h>r;r++){var l=s[r],c={};"string"!=typeof s[r]&&(c=e.merge(l.data,{}),l=l.nodeTo),t.addAdjacence(n[a],i(l),c)}}}(i,t):function(e,t){if(e.addNode(t),t.children)for(var n=0,i=t.children;n<i.length;n++)e.addAdjacence(t,i[n]),arguments.callee(e,i[n])}(i,t),i},loadJSON:function(t,n){this.json=t,this.labels&&this.labels.clearLabels&&this.labels.clearLabels(!0),this.graph=this.construct(t),"array"!=e.type(t)?this.root=t.id:this.root=t[n?n:0].id},toJSON:function(e){if(e=e||"tree","tree"==e){var t={},n=this.graph.getNode(this.root),t=function a(e){var t={};t.id=e.id,t.name=e.name,t.data=e.data;var n=[];return e.eachSubnode(function(e){n.push(a(e))}),t.children=n,t}(n);return t}var t=[],i=!!this.graph.getNode(this.root).visited;return this.graph.eachNode(function(e){var n={};n.id=e.id,n.name=e.name,n.data=e.data;var a=[];e.eachAdjacency(function(e){var t=e.nodeTo;if(!!t.visited===i){var n={};n.nodeTo=t.id,n.data=e.data,a.push(n)}}),n.adjacencies=a,t.push(n),e.visited=!i}),t}},b=$jit.Layouts={},x={label:null,compute:function(t,n,i){this.initializeLabel(i);var a=this.label,o=a.style;t.eachNode(function(t){var n=t.getData("autoWidth"),i=t.getData("autoHeight");if(n||i){delete t.data.$width,delete t.data.$height,delete t.data.$dim;var s=t.getData("width"),r=t.getData("height");o.width=n?"auto":s+"px",o.height=i?"auto":r+"px",a.innerHTML=t.name;var h=a.offsetWidth,l=a.offsetHeight,c=t.getData("type");if(-1===e.indexOf(["circle","square","triangle","star"],c))t.setData("width",h),t.setData("height",l);else{var d=h>l?h:l;t.setData("width",d),t.setData("height",d),t.setData("dim",d)}}})},initializeLabel:function(e){this.label||(this.label=document.createElement("div"),document.body.appendChild(this.label)),this.setLabelStyles(e)},setLabelStyles:function(t){e.extend(this.label.style,{visibility:"hidden",position:"absolute",width:"auto",height:"auto"}),this.label.className="jit-autoadjust-label"}};b.Tree=function(){function n(e,t,n,i,a){var o=t.Node,s=t.multitree;if(o.overridable){var r=-1,h=-1;return e.eachNode(function(e){if(e._depth==n&&(!s||"$orn"in e.data&&e.data.$orn==i)){var t=e.getData("width",a),o=e.getData("height",a);r=t>r?t:r,h=o>h?o:h}}),{width:0>r?o.width:r,height:0>h?o.height:h}}return o}function i(e,t,n,i){var a="left"==i||"right"==i?"y":"x";e.getPos(t)[a]+=n}function a(t,n){var i=[];return e.each(t,function(e){e=u.call(e),e[0]+=n,e[1]+=n,i.push(e)}),i}function o(e,t){if(0==e.length)return t;if(0==t.length)return e;var n=e.shift(),i=t.shift();return[[n[0],i[1]]].concat(o(e,t))}function s(e,t){if(t=t||[],0==e.length)return t;var n=e.pop();return s(e,o(n,t))}function r(e,t,n,i,a){if(e.length<=a||t.length<=a)return 0;var o=e[a][1],s=t[a][0];return Math.max(r(e,t,n,i,++a)+n,o-s+i)}function h(e,t,n){function i(e,s,h){if(s.length<=h)return[];var l=s[h],c=r(e,l,t,n,0);return[c].concat(i(o(e,a(l,c)),s,++h))}return i([],e,0)}function l(e,t,n){function i(e,s,h){if(s.length<=h)return[];var l=s[h],c=-r(l,e,t,n,0);return[c].concat(i(o(a(l,c),e),s,++h))}e=u.call(e);var s=i([],e.reverse(),0);return s.reverse()}function c(e,t,n,i){var a=h(e,t,n),o=l(e,t,n);"left"==i?o=a:"right"==i&&(a=o);for(var s=0,r=[];s<a.length;s++)r[s]=(a[s]+o[s])/2;return r}function d(e,t,o,r,h){function l(t,u,f){var g=t.getData(m,o),N=u||t.getData(y,o),C=[],L=[],D=!1,S=N+r.levelDistance;t.eachSubnode(function(t){if(t.exist&&(!d||"$orn"in t.data&&t.data.$orn==h)){D||(D=n(e,r,t._depth,h,o));var i=l(t,D[y],f+S);C.push(i.tree),L.push(i.extent)}});for(var O=c(L,x,b,w),M=0,T=[];M<C.length;M++)i(C[M],o,O[M],h),T.push(a(L[M],O[M]));var P=[[-g/2,g/2]].concat(s(T));return t.getPos(o)[p]=0,"top"==h||"left"==h?t.getPos(o)[v]=f:t.getPos(o)[v]=-f,{tree:t,extent:P}}var d=r.multitree,u=["x","y"],f=["width","height"],g=+("left"==h||"right"==h),p=u[g],v=u[1-g],m=(r.Node,f[g]),y=f[1-g],b=r.siblingOffset,x=r.subtreeOffset,w=r.align;l(t,!1,0)}var u=Array.prototype.slice;return new t({compute:function(t,n){var i=t||"start",a=this.graph.getNode(this.root);e.extend(a,{drawn:!0,exist:!0,selected:!0}),x.compute(this.graph,i,this.config),!n&&"_depth"in a||this.graph.computeLevels(this.root,0,"ignore"),this.computePositions(a,i)},computePositions:function(t,n){var i=this.config,a=i.multitree,o=i.align,s="center"!==o&&i.indent,r=i.orientation,h=a?["top","right","bottom","left"]:[r],l=this;e.each(h,function(e){d(l.graph,t,n,l.config,e,n);var i=["x","y"][+("left"==e||"right"==e)];!function r(t){t.eachSubnode(function(h){h.exist&&(!a||"$orn"in h.data&&h.data.$orn==e)&&(h.getPos(n)[i]+=t.getPos(n)[i],s&&(h.getPos(n)[i]+="left"==o?s:-s),r(h))})}(t)})}})}(),b.Radial=new t({compute:function(t){var n=e.splat(t||["current","start","end"]);x.compute(this.graph,n,this.config),this.graph.computeLevels(this.root,0,"ignore");var i=this.createLevelDistanceFunc();this.computeAngularWidths(n),this.computePositions(n,i)},computePositions:function(e,t){for(var n=e,i=this.graph,a=i.getNode(this.root),o=this.parent,s=(this.config,0),r=n.length;r>s;s++){var h=n[s];a.setPos(d(0,0),h),a.setData("span",2*Math.PI,h)}a.angleSpan={begin:0,end:2*Math.PI},i.eachBFS(this.root,function(e){var i=e.angleSpan.end-e.angleSpan.begin,a=e.angleSpan.begin,s=t(e),r=0,h=[],l={};e.eachSubnode(function(e){r+=e._treeAngularWidth;for(var t=0,i=n.length;i>t;t++){var a=n[t],o=e.getData("dim",a);l[a]=a in l?o>l[a]?o:l[a]:o}h.push(e)},"ignore"),o&&o.id==e.id&&h.length>0&&h[0].dist&&h.sort(function(e,t){return(e.dist>=t.dist)-(e.dist<=t.dist)});for(var c=0,u=h.length;u>c;c++){var f=h[c];if(!f._flag){
for(var g=f._treeAngularWidth/r*i,p=a+g/2,v=0,m=n.length;m>v;v++){var y=n[v];f.setPos(d(p,s),y),f.setData("span",g,y),f.setData("dim-quotient",f.getData("dim",y)/l[y],y)}f.angleSpan={begin:a,end:a+g},a+=g}}},"ignore")},setAngularWidthForNodes:function(e){this.graph.eachBFS(this.root,function(t,n){var i=t.getData("angularWidth",e[0])||5;t._angularWidth=i/n},"ignore")},setSubtreesAngularWidth:function(){var e=this;this.graph.eachNode(function(t){e.setSubtreeAngularWidth(t)},"ignore")},setSubtreeAngularWidth:function(e){var t=this,n=e._angularWidth,i=0;e.eachSubnode(function(e){t.setSubtreeAngularWidth(e),i+=e._treeAngularWidth},"ignore"),e._treeAngularWidth=Math.max(n,i)},computeAngularWidths:function(e){this.setAngularWidthForNodes(e),this.setSubtreesAngularWidth()}}),$jit.RGraph=new t({Implements:[y,h,b.Radial],initialize:function(t){var n=$jit.RGraph,i={interpolation:"linear",levelDistance:100};this.controller=this.config=e.merge(a("Canvas","Node","Edge","Fx","Controller","Tips","NodeStyles","Events","Navigation","Label"),i,t);var o=this.config;o.useCanvas?(this.canvas=o.useCanvas,this.config.labelContainer=this.canvas.id+"-label"):(o.background&&(o.background=e.merge({type:"Circles"},o.background)),this.canvas=new l(this,o),this.config.labelContainer=("string"==typeof o.injectInto?o.injectInto:o.injectInto.id)+"-label"),this.graphOptions={klass:c,Node:{selected:!1,exist:!0,drawn:!0}},this.graph=new p(this.graphOptions,this.config.Node,this.config.Edge),this.labels=new n.Label[o.Label.type](this),this.fx=new n.Plot(this,n),this.op=new n.Op(this),this.json=null,this.root=null,this.busy=!1,this.parent=!1,this.initializeExtras()},createLevelDistanceFunc:function(){var e=this.config.levelDistance;return function(t){return(t._depth+1)*e}},refresh:function(){this.compute(),this.plot()},reposition:function(){this.compute("end")},plot:function(){this.fx.plot()},getNodeAndParentAngle:function(e){var t=!1,n=this.graph.getNode(e),i=n.getParents(),a=i.length>0?i[0]:!1;if(a){var o=a.pos.getc(),s=n.pos.getc(),r=o.add(s.scale(-1));t=Math.atan2(r.y,r.x),0>t&&(t+=2*Math.PI)}return{parent:a,theta:t}},tagChildren:function(e,t){if(e.angleSpan){var n=[];e.eachAdjacency(function(e){n.push(e.nodeTo)},"ignore");for(var i=n.length,a=0;i>a&&t!=n[a].id;a++);for(var o=(a+1)%i,s=0;t!=n[o].id;o=(o+1)%i)n[o].dist=s++}},onClick:function(t,n){if(this.root!=t&&!this.busy){this.busy=!0,this.root=t;var i=this;this.controller.onBeforeCompute(this.graph.getNode(t));var a=this.getNodeAndParentAngle(t);this.tagChildren(a.parent,t),this.parent=a.parent,this.compute("end");var o=a.theta-a.parent.endPos.theta;this.graph.eachNode(function(e){e.endPos.set(e.endPos.getp().add(d(o,0)))});var s=this.config.interpolation;n=e.merge({onComplete:e.empty},n||{}),this.fx.animate(e.merge({hideLabels:!0,modes:[s]},n,{onComplete:function(){i.busy=!1,n.onComplete()}}))}}}),$jit.RGraph.$extend=!0,function(n){n.Op=new t({Implements:p.Op}),n.Plot=new t({getAlignedPos:function(e,t,n){var i,a,o=this.node;if("center"==o.align)i={x:e.x-t/2,y:e.y-n/2};else if("left"==o.align)a=this.config.orientation,i="bottom"==a||"top"==a?{x:e.x-t/2,y:e.y}:{x:e.x,y:e.y-n/2};else{if("right"!=o.align)throw"align: not implemented";a=this.config.orientation,i="bottom"==a||"top"==a?{x:e.x-t/2,y:e.y-n}:{x:e.x-t,y:e.y-n/2}}return i},getOrientation:function(e){var t=this.config,n=t.orientation;if(t.multitree){var i=e.nodeFrom,a=e.nodeTo;n="$orn"in i.data&&i.data.$orn||"$orn"in a.data&&a.data.$orn}return n},Implements:p.Plot}),n.Label={},n.Label.Native=new t({Implements:p.Label.Native}),n.Label.SVG=new t({Implements:p.Label.SVG,initialize:function(e){this.viz=e},placeLabel:function(e,t,n){var i=t.pos.getc(!0),a=this.viz.canvas,o=a.translateOffsetX,s=a.translateOffsetY,r=a.scaleOffsetX,h=a.scaleOffsetY,l=a.getSize(),c={x:Math.round(i.x*r+o+l.width/2),y:Math.round(i.y*h+s+l.height/2)};e.setAttribute("x",c.x),e.setAttribute("y",c.y),n.onPlaceLabel(e,t)}}),n.Label.HTML=new t({Implements:p.Label.HTML,initialize:function(e){this.viz=e},placeLabel:function(e,t,n){var i=t.pos.getc(!0),a=this.viz.canvas,o=a.translateOffsetX,s=a.translateOffsetY,r=a.scaleOffsetX,h=a.scaleOffsetY,l=a.getSize(),c={x:Math.round(i.x*r+o+l.width/2),y:Math.round(i.y*h+s+l.height/2)},d=e.style;d.left=c.x+"px",d.top=c.y+"px",d.display=this.fitsInCanvas(c,a)?"":"none",n.onPlaceLabel(e,t)}}),n.Plot.NodeTypes=new t({none:{render:e.empty,contains:e.lambda(!1)},circle:{render:function(e,t){var n=e.pos.getc(!0),i=e.getData("dim");this.nodeHelper.circle.render("fill",n,i,t)},contains:function(e,t){var n=e.pos.getc(!0),i=e.getData("dim");return this.nodeHelper.circle.contains(n,t,i)}},ellipse:{render:function(e,t){var n=e.pos.getc(!0),i=e.getData("width"),a=e.getData("height");this.nodeHelper.ellipse.render("fill",n,i,a,t)},contains:function(e,t){var n=e.pos.getc(!0),i=e.getData("width"),a=e.getData("height");return this.nodeHelper.ellipse.contains(n,t,i,a)}},square:{render:function(e,t){var n=e.pos.getc(!0),i=e.getData("dim");this.nodeHelper.square.render("fill",n,i,t)},contains:function(e,t){var n=e.pos.getc(!0),i=e.getData("dim");return this.nodeHelper.square.contains(n,t,i)}},rectangle:{render:function(e,t){var n=e.pos.getc(!0),i=e.getData("width"),a=e.getData("height");this.nodeHelper.rectangle.render("fill",n,i,a,t)},contains:function(e,t){var n=e.pos.getc(!0),i=e.getData("width"),a=e.getData("height");return this.nodeHelper.rectangle.contains(n,t,i,a)}},triangle:{render:function(e,t){var n=e.pos.getc(!0),i=e.getData("dim");this.nodeHelper.triangle.render("fill",n,i,t)},contains:function(e,t){var n=e.pos.getc(!0),i=e.getData("dim");return this.nodeHelper.triangle.contains(n,t,i)}},star:{render:function(e,t){var n=e.pos.getc(!0),i=e.getData("dim");this.nodeHelper.star.render("fill",n,i,t)},contains:function(e,t){var n=e.pos.getc(!0),i=e.getData("dim");return this.nodeHelper.star.contains(n,t,i)}}}),n.Plot.EdgeTypes=new t({none:e.empty,line:{render:function(e,t){var n=e.nodeFrom.pos.getc(!0),i=e.nodeTo.pos.getc(!0);this.edgeHelper.line.render(n,i,t)},contains:function(e,t){var n=e.nodeFrom.pos.getc(!0),i=e.nodeTo.pos.getc(!0);return this.edgeHelper.line.contains(n,i,t,this.edge.epsilon)}},arrow:{render:function(e,t){var n=e.nodeFrom.pos.getc(!0),i=e.nodeTo.pos.getc(!0),a=e.getData("dim"),o=e.data.$direction,s=o&&o.length>1&&o[0]!=e.nodeFrom.id;this.edgeHelper.arrow.render(n,i,a,s,t)},contains:function(e,t){var n=e.nodeFrom.pos.getc(!0),i=e.nodeTo.pos.getc(!0);return this.edgeHelper.arrow.contains(n,i,t,this.edge.epsilon)}}})}($jit.RGraph)}();